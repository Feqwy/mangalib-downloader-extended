# MangaLib Downloader

Асинхронный загрузчик манги с MangaLib с поддержкой метаданных для Komga/Mylar.

## Структура проекта

```
manga_downloader/
├── config.py          # Конфигурация приложения
├── colors.py          # Цветной вывод в консоль
├── models.py          # Модели данных
├── api_client.py      # API клиент для MangaLib
├── metadata.py        # Генерация метаданных (ComicInfo.xml, series.json)
├── downloader.py      # Основная логика скачивания
├── main.py            # Точка входа
├── requirements.txt   # Зависимости
└── README.md          # Документация
```

## Установка

Вы можете собрать проект из исходников или загрузить готовую сборку с [страницы релизов](https://github.com/Feqwy/mangalib-downloader-extended/releases).

## Использование

После запуска программа предложит настроить такие параметры как:

```
URL манги — ссылка с MangaLib.
Начальная глава — первая глава для загрузки.
Конечная глава — последняя глава для загрузки.
Дополнительные главы — например: 0.5, 10.1 (можно оставить пустым).
Название манги — можно задать своё или оставить стандартное.
Максимум одновременно загружаемых глав — влияет на скорость загрузки (Можно оставить по умолчанию).
Максимум одновременно загружаемых изображений — регулировка параллельности (Можно оставить по умолчанию).
Задержка между запросами — помогает избежать блокировок (Можно оставить по умолчанию).
Собирать CBZ-архивы? (y/n) — определяет, будут ли главы упакованы.
Создавать метаданные? (y/n) — ComicInfo, series.json.
```

После ввода параметров программа автоматически начнёт загрузку выбранных глав.

---

## Структура выходных файлов

```
downloads/
└── Series_Name.zip
    └── Series_Name/
        ├── ComicInfo.xml          # Метаданные серии
        ├── series.json            # Метаданные для Komga/Mylar
        ├── cover.jpg              # Обложка серии (+ другие варианты)
        └── Volume 01/
            ├── ComicInfo.xml      # Метаданные тома
            ├── Chapter 001.cbz    # Глава в формате CBZ
            ├── Chapter 002.cbz
            └── ...
```

```
downloads/
└── Series_Name/
    ├── cover.jpg
    └── Volume 01/
        ├── Chapter 001/
        │   ├── 001.jpg
        │   ├── 002.jpg            # Режим без CBZ и метаданных
        │   ├── 003.jpg
        │   └── ...
```

### Формат CBZ

Каждый файл `.cbz` содержит:
- Изображения страниц (001.jpg, 002.jpg, ...)
- `ComicInfo.xml` - метаданные главы
- `info.txt` - дополнительная информация в JSON

## Возможности

- Интерактивная CLI-настройка конфигурации (ввод параметров через консоль)
- Асинхронное скачивание с контролем параллелизма
- Поддержка дробных глав и дополнительных `extra_chapters`
- Автоматическое определение томов
- Обработка rate limits (429)
- Повторные попытки при ошибках
- Прогресс-бары для глав и страниц
- Метаданные для Komga/Mylar/Kavita
- Цветной вывод в консоль
- Модульная архитектура

## Примечания

- При высоких значениях максимумов (максимум одновременно загружаемых изображений и максимум одновременно загружаемых глав) возможны rate limits (429)
- Увеличьте `Задержку между запросами` если получаете ошибки 403/429
- Для корректной работы требуется стабильное интернет-соединение

## Troubleshooting

**Ошибка 429 (Too Many Requests)**
- Увеличьте `Задержку между запросами`
- Уменьшите `Максимум одновременно загружаемых изображений`

**Ошибка 403 (Forbidden)**
- Скрипт автоматически прогревает сессию
- Если проблема сохраняется, увеличьте `Задержку между запросами`

---

Этот инструмент предназначен только для образовательных целей. Пожалуйста, уважайте авторские права и условия использования MangaLib.